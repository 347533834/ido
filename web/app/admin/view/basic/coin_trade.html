{include file="common/head"/}
<div class="admin-main layui-anim layui-anim-upbit">
    <fieldset class="layui-elem-field layui-field-title">
        <legend>交易对配置</legend>
    </fieldset>
    <div class="demoTable">
        <a href="{:url('coin_trade_add')}" class="layui-btn layui-btn-small">
            {:lang('add')}配置
        </a>
 <!--       <div class="layui-inline">
            <input class="layui-input" name="key" id="key" placeholder="{:lang('pleaseEnter')}关键字">
        </div>
        <button class="layui-btn" id="search" data-type="reload">搜索</button>
        <a href="{:url('coin_trade')}" class="layui-btn">显示全部</a>
    </div>-->
    <table class="layui-table" id="list" lay-filter="list"></table>
</div>

<script type="text/html" id="status">
    <input type="checkbox" name="status" value="{{d.id}}" lay-skin="switch" lay-text="是|否" lay-filter="status" {{ d.status== 1 ? 'checked' : '' }}>
</script>

<script type="text/html" id="action">
    <a href="{:url('coin_trade_edit')}?id={{d.id}}" class="layui-btn layui-btn-xs">编辑</a>

    <a href="#" class="layui-btn layui-btn-danger layui-btn-xs" lay-event="del">{:lang('del')}</a>
</script>
<script type="text/html" id="email">

</script>
<script type="text/html" id="node">

</script>
{include file="common/foot"/}
<script>
    layui.use(['table', 'form'], function () {
        var table = layui.table, form = layui.form, $ = layui.jquery;
        var tableIn = table.render({
            id: 'id',
            elem: '#list',
            url: '{:url("coin_trade")}',
            method: 'post',
            page: true,
            cols: [[
                {checkbox: true, fixed: true},
                {field: 'id', title: '编号', align: 'center', fixed: true},
                {field: 'trade_name', title: '交易对名', width:120,align: 'center', fixed: true},
                {field: 'main_coin_id', title: '分区通证id',width:120, align: 'center'},
                {field: 'main_coin_name', title: '分区通证名',width:120, align: 'center'},
                {field: 'exch_coin_id', title: '兑换通证id',width:120, align: 'center'},
                {field: 'exch_coin_name', title: '兑换通证名',width:120, align: 'center'},
              //  {field: 'price', title: '价格',width:120, align: 'center'},
                {field: 'status', title: '是否开启', width:120,align: 'center',toolbar: '#status'},
                {field: 'maker_fee', title: '挂单手续费',width:120, align: 'center' },
                {field: 'taker_fee', title: '吃单手续费',width:120, align: 'center' },
                {field: 'sort', title: '排序',width:120, align: 'center'},
//                {field: 'buy_fee', title: '买入手续费',width:120, align: 'center' },
//                {field: 'sell_fee', title: '卖出手续费',width:120, align: 'center' },
//                {field: 'buy_fee_min', title: '最小买入手续费',width:140, align: 'center'},
//                {field: 'sell_fee_min', title: '最小卖出手续费', width:140,align: 'center'},
                {field: 'num_min', title: '最小交易数量',width:140, align: 'center'},
                {field: 'addtime', title: '添加时间',width:180, align: 'center',sort:true},
                {field: 'remark', title: '备注', align: 'center'},
                {field: 'change', title: '涨跌幅', align: 'center'},
                {title: '操作', align:'center',width:120, toolbar: '#action'},


            ]],
            limit: 10 //每页默认显示的数量
        });
        form.on('switch(status)', function (obj) {
            loading = layer.load(1, {shade: [0.1, '#fff']});
            var id = this.value;
            var status = obj.elem.checked === true ? 1 : 0;
            $.post('{:url("coin_trade_status")}', {'id': id, 'status': status}, function (res) {
                layer.close(loading);
                if (res.status == 1) {
                    tableIn.reload();
                } else {
                    layer.msg(res.msg, {time: 1000, icon: 2});
                    return false;
                }
            })
        });
        //搜索
        $('#search').on('click', function () {
            var key = $('#key').val();
            if ($.trim(key) === '') {
                layer.msg('{:lang("pleaseEnter")}关键字！', {icon: 0});
                return;
            }
            tableIn.reload({
                where: {key: key}
            });
        });
//删除按钮
        table.on('tool(list)', function(obj){
            var data = obj.data;
            if(obj.event === 'del'){
                layer.confirm('{:lang("Are you sure you want to delete it")}', function(index){
                    $.post("{:url('coin_trade_del')}",{id:data.id},function(res){
                        if(res.code==1){
                            layer.msg(res.msg,{time:1000,icon:1});
                            obj.del();
                        }else{
                            layer.msg(res.msg,{time:1000,icon:2});
                        }
                    });
                    layer.close(index);
                });
            }
        });

    });
</script>
</body>
</html>